<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>VORN ‚Äî Future World</title>
  <meta name="theme-color" content="#0a0014"/>
  <link rel="stylesheet" href="/webapp/style.css?v=2"/>

  <!-- Hard lock to prevent scroll/white flash in Telegram WebView -->
  <style>
    html, body {
      height: 100vh;
      overflow: hidden;
      position: fixed;
      width: 100%;
      top: 0; left: 0;
      margin: 0; padding: 0;
      background-color: #000;
    }
  </style>
</head>

<body>

<!-- GOOGLE VERIFICATION INTRO -->
<!-- GOOGLE VERIFICATION INFO (visible only to crawlers / hidden in app) -->
<section id="about-vorn"
  style="text-align:center; padding:40px 20px; color:#ddd; font-family:sans-serif; background:rgba(0,0,0,0.7);">
  <h2>About VORN App</h2>
  <p style="max-width:700px; margin:auto; line-height:1.6;">
    <strong>VORN</strong> is a gamified Telegram WebApp where users earn in-game currency by completing
    daily and social tasks.  
    The app uses Google APIs only for verifying specific YouTube actions like likes, comments, and subscriptions,
    ensuring that rewards are granted fairly.  
    No personal data is stored or shared outside this verification process.
  </p>
  <p style="max-width:700px; margin:20px auto 0;">
    Learn more in our <a href="/privacy.html" style="color:#ffd54a;">Privacy Policy</a>.
  </p>
</section>

<script>
  // Hide the Google info once the app starts (so it doesn‚Äôt cover intro)
  document.addEventListener("DOMContentLoaded", () => {
    const about = document.getElementById("about-vorn");
    // Wait for the START button or app UI to appear
    const observer = new MutationObserver(() => {
      const mainUI = document.getElementById("mainUI");
      if (mainUI && !mainUI.classList.contains("hidden")) {
        about.style.display = "none";
        observer.disconnect();
      }
    });
    observer.observe(document.body, { childList: true, subtree: true });

    // Also hide if Telegram WebApp is detected
    if (window.Telegram?.WebApp) {
      about.style.display = "none";
    }
  });
</script>



  <!-- Canvas background (stars/fog/ripples) -->
  <canvas id="vornCanvas"></canvas>

  <!-- Optional layered decorations -->
  <div id="sacredGlow"></div>
  <div id="movingFog"></div>
  <div id="crowShadow"></div>

  <!-- Static layered background (kept for your styles) -->
  <div id="vorn-bg">
    <div class="stars-layer"></div>
    <div class="fog-layer"></div>
    <div class="branches-layer"></div>
    <div class="glow-layer"></div>
    <img src="/webapp/assets/interface_male.png" alt="VORN background" id="static-bg">
  </div>

  <!-- Extra effect layers -->
  <div id="starLayer"></div>
  <div id="glowLayer"></div>
  <div id="fogLayer"></div>

  <!-- INTRO VIDEO -->
  <video id="introVideo" autoplay muted playsinline preload="auto" loop>
    <source src="/webapp/crow_fly.mp4" type="video/mp4">
  </video>

  <!-- INTRO TEXT -->
  <div class="intro-text">
    <h1>üúÇ Welcome to the World of the Future</h1>
  </div>

  <!-- START BUTTON (fixed position centered lower on screen) -->
<div id="startContainer">
  <button id="startBtn">START</button>
</div>


<style>
#startContainer {
  position: fixed;
  bottom: 12%;             /* üëà ’Ω’° ’´’ª’•÷Å’∂’∏÷Ç’¥ ’ß ’Ø’∏’≥’°’Ø’® ’∂’•÷Ä÷Ñ÷á’ù ’ß’Ø÷Ä’°’∂’´ 12%-’´’∂ ’¥’∏’ø */
  left: 50%;
  transform: translateX(-50%);
  width: 100%;
  text-align: center;
  z-index: 1000;
}

#startBtn {
  background: linear-gradient(135deg, #ffae00, #ffcc33);
  color: #26004d;
  border: none;
  padding: 16px 40px;
  font-size: 1.2rem;
  border-radius: 30px;
  cursor: pointer;
  font-weight: bold;
  transition: all 0.3s ease;
  box-shadow: 0 0 15px rgba(255, 191, 0, 0.6);
}

#startBtn:hover {
  transform: scale(1.05);
  box-shadow: 0 0 25px rgba(255, 200, 0, 0.8);
}
</style>



  <!-- LANGUAGE PICKER -->
  <div id="languageModal" class="modal hidden">
    <div class="modal-content">
      <h2>üåê Select Your Language</h2>
      <p class="muted">You can‚Äôt change it later.</p>
      <div id="lang-grid" class="lang-grid"></div>
      <button id="closeLangBtn" class="close-btn">‚úñ Close</button>
    </div>
  </div>

  <!-- CONFIRM LANGUAGE -->
  <div id="confirmLangModal" class="modal hidden">
    <div class="modal-content">
      <h2 id="confirmLangTitle">‚úÖ</h2>
      <p id="confirmLangText"></p>
      <div class="row gap">
        <button id="changeLangBtn" class="secondary-btn">üîÅ Change</button>
        <button id="confirmLangBtn" class="primary-btn">‚úî Confirm</button>
      </div>
    </div>
  </div>

  <!-- SLIDES -->
  <section id="introSlides" class="hidden">
    <img id="slideImage" src="/webapp/assets/slide1.png" alt="Slide 1">
    <div class="slide-cta">
      <button id="slideNextBtn">Continue</button>
    </div>
  </section>

  <!-- BG (you use IMG; JS supports video too) -->
  <img id="mainBgVideo" src="/webapp/assets/interface_male.png" class="hidden" alt="VORN background">

  <!-- === MAIN INTERFACE UI === -->
  <div id="mainUI" class="hidden">

    <!-- TOP BAR -->
    <div class="ui-top">
      <div class="ui-left">üë§ <span id="username">Player059</span></div>

      <div class="ui-right">
  <div class="coins-block">
    <div class="coins-line">
      ü™∂ <span id="featherCount">0</span>
      &nbsp;&nbsp;üúÇ <span id="foodCount">0</span>
    </div>
  </div>
</div>

<!-- Exchange button OUTSIDE coins block -->
<div id="exchangeContainer">
  <button id="btnExchange" class="exchange-btn" title="Exchange">üîÅ</button>
</div>

    </div>

    <!-- CROW AREA + ENERGY + CLICK ZONE -->
    <div id="crowArea">
      <div id="crowGlow"></div>

      <!-- ENERGY BAR -->
      <div id="energyBar" class="hidden">
        <div id="energyFill"></div>
      </div>

      <!-- CLICK ZONE -->
      <div id="clickZone" title="Tap to mine"></div>
    </div>

    <!-- PROGRESS BAR -->
    <div class="progress-bar">
      <div class="progress-fill" id="progressFill"></div>
    </div>

    <!-- BOTTOM MENU -->
    <div class="ui-bottom icon-bar">
      <button class="menu-btn" id="btnTasks">üìú</button>
      <button class="menu-btn" id="btnReferral">ü§ù</button>

      <button class="mine-btn" id="btnMine" aria-label="Mine" title="Mine">
        <span class="mine-progress"></span>
        <span class="mine-icon">ü™∂</span>
      </button>

      <button class="menu-btn" id="btnWallet">üí∞</button>
      <button class="menu-btn" id="btnInfo">‚ÑπÔ∏è</button>
    </div>
  </div>


<!-- üß© REFERRALS MODAL -->
<div id="referralsModal" class="modal hidden">
  <div class="modal-content referral-box">
    <h2 id="referralTitle">ü§ù Referrals</h2>

    <div class="ref-link-box">
      <p id="refLinkText" class="muted small">Loading...</p>
      <button id="copyRefLinkBtn">üìã Copy Link</button>
    </div>

    <div id="refTop3" class="ref-top3"></div>
    <div id="refList" class="ref-list"></div>
    <div id="refResult" class="ref-result"></div>

    <div class="ref-actions">
      <button id="refPreviewBtn">üßÆ Calculate</button>
      <button id="refClaimBtn" class="hidden">üí∞ Claim</button>
      <button id="closeRefBtn">‚úñ Close</button>
    </div>
  </div>
</div>




    <!-- üß© TASKS MODAL -->
<div id="tasksModal" class="modal hidden">
  <div class="modal-content tasks-box">
    <h2>üìú Tasks</h2>
    <p class="muted">Complete missions to earn ü™∂ Feathers!</p>
    <div id="tasksList" class="tasks-list"></div>
    <button id="closeTasksBtn" class="close-btn">‚úñ Close</button>
  </div>
</div>

<!-- üß© INFO MODAL -->
<div id="infoModal" class="modal hidden">
  <div class="modal-content info-box">
    <h2 id="infoTitle">‚ÑπÔ∏è Information</h2>
    <div id="infoText" class="info-text"></div>
    <button id="closeInfoBtn" class="close-btn">‚úñ Close</button>
  </div>
</div>

<style>
  .info-box {
    max-height: 80vh;
    overflow-y: auto;
    background: rgba(15, 5, 30, 0.9);
    color: #fff;
    border-radius: 20px;
    padding: 20px;
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
    transform: scale(0.9);
    opacity: 0;
    transition: all 0.3s ease;
  }
  .modal:not(.hidden) .info-box {
    transform: scale(1);
    opacity: 1;
  }
  .info-text h3 {
    margin-top: 18px;
    color: #ffd54a;
  }
  .info-text p {
    font-size: 0.95rem;
    line-height: 1.5;
  }
  .info-text a {
    color: #ffcc33;
    text-decoration: none;
  }
  .info-text a:hover {
    text-decoration: underline;
  }
</style>

<style>
  /* üåå Unified VORN modal aesthetic (referrals + info + tasks) */
  .referral-box {
    position: relative;
    background: radial-gradient(circle at 50% 40%, rgba(30, 10, 50, 0.95), rgba(10, 0, 20, 0.96));
    color: #fff;
    border-radius: 22px;
    padding: 22px;
    max-width: 600px;
    width: 92%;
    margin: auto;
    box-shadow: 0 0 25px rgba(255, 215, 0, 0.18), 0 0 60px rgba(140, 80, 255, 0.15);
    transform: scale(0.9);
    opacity: 0;
    transition: all 0.35s ease;
    max-height: 85vh;
    overflow-y: auto;
    backdrop-filter: blur(8px);
  }

  .modal:not(.hidden) .referral-box {
    transform: scale(1);
    opacity: 1;
  }

  #referralsModal h2 {
    text-align: center;
    color: #ffd54a;
    text-shadow: 0 0 12px rgba(255, 215, 0, 0.4);
    margin-bottom: 15px;
  }

  .ref-link-box {
    text-align: center;
    background: rgba(255, 255, 255, 0.04);
    border-radius: 12px;
    padding: 10px 12px;
    margin-bottom: 20px;
    box-shadow: inset 0 0 10px rgba(255,255,255,0.05);
  }

  #copyRefLinkBtn {
    margin-top: 10px;
    background: linear-gradient(135deg, #ffae00, #ffcc33);
    color: #26004d;
    border: none;
    padding: 8px 18px;
    border-radius: 25px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  #copyRefLinkBtn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 15px rgba(255, 200, 0, 0.8);
  }

  .ref-top3 {
    display: grid;
    gap: 12px;
    margin: 10px 0;
  }

  .ref-trophy {
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 12px;
    padding: 8px 10px;
    background: rgba(255,255,255,0.05);
    display: flex;
    align-items: center;
    justify-content: space-between;
    color: #fff;
  }

  .ref-trophy-medal {
    font-size: 1.3rem;
  }

  .ref-trophy-name {
    flex: 1;
    text-align: center;
    font-weight: bold;
  }

  .ref-trophy-stats {
    font-size: 0.9rem;
    opacity: 0.9;
  }

  .ref-list {
    margin-top: 15px;
    border-top: 1px solid rgba(255,255,255,0.1);
  }

  .ref-row {
    display: flex;
    justify-content: space-between;
    padding: 6px 0;
    border-bottom: 1px solid rgba(255,255,255,0.08);
    font-size: 0.9rem;
  }

  .ref-actions {
    display: flex;
    justify-content: space-around;
    margin-top: 15px;
  }

  .ref-actions button {
    background: rgba(255,255,255,0.08);
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 8px 14px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .ref-actions button:hover {
    background: rgba(255,255,255,0.15);
  }

  .ref-result {
    text-align: center;
    color: #ffd54a;
    font-weight: 600;
    margin-top: 8px;
  }

  /* ‚ú® ’Ä’°’æ’•’¨’µ’°’¨ ’∑’∏’≤ */
  .referral-box::before {
    content: "";
    position: absolute;
    inset: 0;
    background: radial-gradient(circle at 50% 0%, rgba(255,215,0,0.08), transparent 70%);
    border-radius: 22px;
    pointer-events: none;
  }

  .modal:not(.hidden) .referral-box {
    transform: scale(1);
    opacity: 1;
  }

  #referralsModal h2 {
    text-align: center;
    color: #ffd54a;
    margin-bottom: 15px;
  }

  .ref-link-box {
    text-align: center;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 10px;
    padding: 10px 12px;
    margin-bottom: 20px;
    box-shadow: inset 0 0 8px rgba(255,255,255,0.05);
  }

  #copyRefLinkBtn {
    margin-top: 10px;
    background: linear-gradient(135deg, #ffae00, #ffcc33);
    color: #26004d;
    border: none;
    padding: 8px 18px;
    border-radius: 25px;
    font-weight: bold;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  #copyRefLinkBtn:hover {
    transform: scale(1.05);
    box-shadow: 0 0 12px rgba(255, 200, 0, 0.8);
  }

  .ref-top3 {
    display: grid;
    gap: 12px;
    margin: 10px 0;
  }

  .ref-trophy {
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 12px;
    padding: 8px 10px;
    background: rgba(255,255,255,0.05);
    display: flex;
    align-items: center;
    justify-content: space-between;
    color: #fff;
  }

  .ref-trophy-medal {
    font-size: 1.3rem;
  }

  .ref-trophy-name {
    flex: 1;
    text-align: center;
    font-weight: bold;
  }

  .ref-trophy-stats {
    font-size: 0.9rem;
    opacity: 0.9;
  }

  .ref-list {
    margin-top: 15px;
    border-top: 1px solid rgba(255,255,255,0.1);
  }

  .ref-row {
    display: flex;
    justify-content: space-between;
    padding: 6px 0;
    border-bottom: 1px solid rgba(255,255,255,0.08);
    font-size: 0.9rem;
  }

  .ref-actions {
    display: flex;
    justify-content: space-around;
    margin-top: 15px;
  }

  .ref-actions button {
    background: rgba(255,255,255,0.08);
    color: #fff;
    border: none;
    border-radius: 8px;
    padding: 8px 14px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .ref-actions button:hover {
    background: rgba(255,255,255,0.15);
  }

  .ref-result {
    text-align: center;
    color: #ffd54a;
    font-weight: 600;
    margin-top: 8px;
  }
</style>


<!-- APP LOGIC -->
<script src="/webapp/app.js?v=4"></script>

<script>
window.addEventListener("vorn_ready", () => {
  console.log("‚úÖ Received vorn_ready ‚Äî binding Start button now‚Ä¶");
  const startBtn = document.getElementById("startBtn");
  const langModal = document.getElementById("languageModal");
  const introText = document.querySelector(".intro-text");
  const startContainer = document.getElementById("startContainer");

  if (!startBtn) {
    console.error("‚ùå startBtn not found in DOM");
    return;
  }

  startBtn.addEventListener("click", () => {
    introText?.classList.add("hidden");
    startContainer?.classList.add("hidden");

    // ‘±’µ’Ω’ø’•’≤ ’°÷Ä’§’•’∂ ’æ’Ω’ø’°’∞ ’•’∂÷Ñ, ’∏÷Ä VORN ’∫’°’ø÷Ä’°’Ω’ø ’ß
    if (window.VORN && typeof VORN.buildLanguageGrid === "function") {
      VORN.buildLanguageGrid();
      console.log("‚úÖ Language grid built via vorn_ready hook");
    } else {
      console.warn("‚ö†Ô∏è VORN.buildLanguageGrid still not ready");
    }

    langModal?.classList.remove("hidden");
  });
});
</script>

<footer style="position:fixed; bottom:8px; width:100%; text-align:center; font-size:0.85rem;">
  <a href="/privacy.html" style="color:#aaa;">Privacy Policy</a> |
  <a href="/terms.html" style="color:#aaa;">Terms of Use</a>
</footer>


</body>
</html>
